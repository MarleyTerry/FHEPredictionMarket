{"version":3,"file":"index.js","sources":["../src/core/FhevmClient.ts","../src/core/EncryptionService.ts","../src/core/DecryptionService.ts","../src/core/ContractService.ts","../src/utils/index.ts"],"sourcesContent":["import { createInstance, initFhevm } from 'fhevmjs';\r\nimport type { BrowserProvider, JsonRpcProvider } from 'ethers';\r\nimport type { FhevmConfig, FhevmInstance, NetworkConfig } from '../types';\r\n\r\n/**\r\n * Main FHEVM Client - Framework agnostic\r\n *\r\n * Usage:\r\n * ```typescript\r\n * const client = new FhevmClient({ provider });\r\n * await client.init();\r\n * const encrypted = await client.encrypt32(42);\r\n * ```\r\n */\r\nexport class FhevmClient {\r\n  private instance: FhevmInstance | null = null;\r\n  private provider: BrowserProvider | JsonRpcProvider;\r\n  private network?: NetworkConfig;\r\n  private publicKeyBytes?: Uint8Array;\r\n  private initialized = false;\r\n\r\n  constructor(config: FhevmConfig) {\r\n    this.provider = config.provider;\r\n    this.network = config.network as NetworkConfig;\r\n    // Convert hex string to Uint8Array if provided\r\n    if (config.publicKey) {\r\n      this.publicKeyBytes = this.hexToUint8Array(config.publicKey);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Initialize the FHEVM client\r\n   */\r\n  async init(): Promise<void> {\r\n    if (this.initialized) {\r\n      return;\r\n    }\r\n\r\n    try {\r\n      // Initialize fhevmjs library\r\n      await initFhevm();\r\n\r\n      // Get network information\r\n      const network = await this.provider.getNetwork();\r\n      const chainId = Number(network.chainId);\r\n\r\n      // Prepare config for createInstance\r\n      const config: any = {\r\n        kmsContractAddress: this.network?.aclAddress || '0x',\r\n        aclContractAddress: this.network?.aclAddress || '0x',\r\n        chainId,\r\n      };\r\n\r\n      // Add public key if available\r\n      if (this.publicKeyBytes) {\r\n        config.publicKey = this.publicKeyBytes;\r\n      }\r\n\r\n      // Add gateway URL if available\r\n      if (this.network?.gatewayUrl) {\r\n        config.gatewayUrl = this.network.gatewayUrl;\r\n      }\r\n\r\n      this.instance = await createInstance(config);\r\n\r\n      this.initialized = true;\r\n    } catch (error) {\r\n      console.error('Failed to initialize FHEVM client:', error);\r\n      throw new Error(`FHEVM initialization failed: ${error}`);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get the underlying FHEVM instance\r\n   */\r\n  getInstance(): FhevmInstance {\r\n    if (!this.instance) {\r\n      throw new Error('FHEVM client not initialized. Call init() first.');\r\n    }\r\n    return this.instance;\r\n  }\r\n\r\n  /**\r\n   * Check if client is initialized\r\n   */\r\n  isInitialized(): boolean {\r\n    return this.initialized;\r\n  }\r\n\r\n  /**\r\n   * Get the public key\r\n   */\r\n  getPublicKey(): { publicKeyId: string; publicKey: Uint8Array } | null {\r\n    const instance = this.getInstance();\r\n    return instance.getPublicKey();\r\n  }\r\n\r\n  /**\r\n   * Helper to convert hex string to Uint8Array\r\n   */\r\n  private hexToUint8Array(hex: string): Uint8Array {\r\n    const cleanHex = hex.startsWith('0x') ? hex.slice(2) : hex;\r\n    const bytes = new Uint8Array(cleanHex.length / 2);\r\n    for (let i = 0; i < bytes.length; i++) {\r\n      bytes[i] = parseInt(cleanHex.substr(i * 2, 2), 16);\r\n    }\r\n    return bytes;\r\n  }\r\n\r\n  /**\r\n   * Create encrypted input builder for a contract\r\n   */\r\n  createEncryptedInput(contractAddress: string, userAddress: string) {\r\n    const instance = this.getInstance();\r\n    return instance.createEncryptedInput(contractAddress, userAddress);\r\n  }\r\n\r\n  /**\r\n   * Generate a keypair for reencryption\r\n   */\r\n  generateKeypair() {\r\n    const instance = this.getInstance();\r\n    return instance.generateKeypair();\r\n  }\r\n\r\n  /**\r\n   * Create EIP-712 signature object\r\n   */\r\n  createEIP712(publicKey: string, contractAddress: string, delegatedAccount?: string) {\r\n    const instance = this.getInstance();\r\n    return instance.createEIP712(publicKey, contractAddress, delegatedAccount);\r\n  }\r\n\r\n  /**\r\n   * Reencrypt a value for the user\r\n   */\r\n  async reencrypt(\r\n    handle: bigint,\r\n    privateKey: string,\r\n    publicKey: string,\r\n    signature: string,\r\n    contractAddress: string,\r\n    userAddress: string\r\n  ): Promise<bigint> {\r\n    const instance = this.getInstance();\r\n    return instance.reencrypt(handle, privateKey, publicKey, signature, contractAddress, userAddress);\r\n  }\r\n}\r\n","import type { FhevmClient } from './FhevmClient';\r\nimport type { EncryptedInput, EncryptedData } from '../types';\r\n\r\n/**\r\n * Service for encrypting values using FHEVM\r\n *\r\n * Usage:\r\n * ```typescript\r\n * const service = new EncryptionService(fhevmClient);\r\n * const encrypted = await service.encryptUint32(100);\r\n * ```\r\n */\r\nexport class EncryptionService {\r\n  private client: FhevmClient;\r\n\r\n  constructor(client: FhevmClient) {\r\n    this.client = client;\r\n  }\r\n\r\n  /**\r\n   * Encrypt a single boolean value\r\n   * This is a convenience method that creates a builder with one value\r\n   */\r\n  async encryptBool(\r\n    value: boolean,\r\n    contractAddress: string,\r\n    userAddress: string\r\n  ): Promise<EncryptedData> {\r\n    if (!this.client.isInitialized()) {\r\n      await this.client.init();\r\n    }\r\n    const builder = this.client.createEncryptedInput(contractAddress, userAddress);\r\n    builder.addBool(value);\r\n    return builder.encrypt();\r\n  }\r\n\r\n  /**\r\n   * Encrypt a single 8-bit unsigned integer\r\n   */\r\n  async encryptUint8(\r\n    value: number,\r\n    contractAddress: string,\r\n    userAddress: string\r\n  ): Promise<EncryptedData> {\r\n    this.validateUint(value, 8);\r\n    if (!this.client.isInitialized()) {\r\n      await this.client.init();\r\n    }\r\n    const builder = this.client.createEncryptedInput(contractAddress, userAddress);\r\n    builder.add8(value);\r\n    return builder.encrypt();\r\n  }\r\n\r\n  /**\r\n   * Encrypt a single 16-bit unsigned integer\r\n   */\r\n  async encryptUint16(\r\n    value: number,\r\n    contractAddress: string,\r\n    userAddress: string\r\n  ): Promise<EncryptedData> {\r\n    this.validateUint(value, 16);\r\n    if (!this.client.isInitialized()) {\r\n      await this.client.init();\r\n    }\r\n    const builder = this.client.createEncryptedInput(contractAddress, userAddress);\r\n    builder.add16(value);\r\n    return builder.encrypt();\r\n  }\r\n\r\n  /**\r\n   * Encrypt a single 32-bit unsigned integer\r\n   */\r\n  async encryptUint32(\r\n    value: number,\r\n    contractAddress: string,\r\n    userAddress: string\r\n  ): Promise<EncryptedData> {\r\n    this.validateUint(value, 32);\r\n    if (!this.client.isInitialized()) {\r\n      await this.client.init();\r\n    }\r\n    const builder = this.client.createEncryptedInput(contractAddress, userAddress);\r\n    builder.add32(value);\r\n    return builder.encrypt();\r\n  }\r\n\r\n  /**\r\n   * Encrypt a single 64-bit unsigned integer\r\n   */\r\n  async encryptUint64(\r\n    value: bigint,\r\n    contractAddress: string,\r\n    userAddress: string\r\n  ): Promise<EncryptedData> {\r\n    this.validateUint64(value);\r\n    if (!this.client.isInitialized()) {\r\n      await this.client.init();\r\n    }\r\n    const builder = this.client.createEncryptedInput(contractAddress, userAddress);\r\n    builder.add64(value);\r\n    return builder.encrypt();\r\n  }\r\n\r\n  /**\r\n   * Create an encrypted input builder for batch encryption\r\n   */\r\n  createEncryptedInputBuilder(contractAddress: string, userAddress: string) {\r\n    if (!this.client.isInitialized()) {\r\n      throw new Error('Client not initialized');\r\n    }\r\n    return this.client.createEncryptedInput(contractAddress, userAddress);\r\n  }\r\n\r\n  /**\r\n   * Encrypt multiple values at once\r\n   */\r\n  async encryptBatch(\r\n    contractAddress: string,\r\n    userAddress: string,\r\n    values: Array<{\r\n      type: 'bool' | 'uint8' | 'uint16' | 'uint32' | 'uint64' | 'address';\r\n      value: boolean | number | bigint | string;\r\n    }>\r\n  ): Promise<EncryptedData> {\r\n    if (!this.client.isInitialized()) {\r\n      await this.client.init();\r\n    }\r\n\r\n    const builder = this.createEncryptedInputBuilder(contractAddress, userAddress);\r\n\r\n    for (const { type, value } of values) {\r\n      switch (type) {\r\n        case 'bool':\r\n          builder.addBool(value as boolean);\r\n          break;\r\n        case 'uint8':\r\n          builder.add8(value as number);\r\n          break;\r\n        case 'uint16':\r\n          builder.add16(value as number);\r\n          break;\r\n        case 'uint32':\r\n          builder.add32(value as number);\r\n          break;\r\n        case 'uint64':\r\n          builder.add64(value as bigint);\r\n          break;\r\n        case 'address':\r\n          builder.addAddress(value as string);\r\n          break;\r\n        default:\r\n          throw new Error(`Unsupported type: ${type}`);\r\n      }\r\n    }\r\n\r\n    return builder.encrypt();\r\n  }\r\n\r\n  /**\r\n   * Validate unsigned integer value\r\n   */\r\n  private validateUint(value: number, bits: 8 | 16 | 32): void {\r\n    if (!Number.isInteger(value)) {\r\n      throw new Error('Value must be an integer');\r\n    }\r\n    if (value < 0) {\r\n      throw new Error('Value must be non-negative');\r\n    }\r\n    const max = 2 ** bits - 1;\r\n    if (value > max) {\r\n      throw new Error(`Value exceeds maximum for uint${bits}: ${max}`);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Validate 64-bit unsigned integer\r\n   */\r\n  private validateUint64(value: bigint): void {\r\n    if (value < 0n) {\r\n      throw new Error('Value must be non-negative');\r\n    }\r\n    const max = 2n ** 64n - 1n;\r\n    if (value > max) {\r\n      throw new Error(`Value exceeds maximum for uint64: ${max}`);\r\n    }\r\n  }\r\n}\r\n","import type { Signer } from 'ethers';\r\nimport type { DecryptionParams, DecryptionResult, EIP712Domain } from '../types';\r\n\r\n/**\r\n * Service for decrypting FHEVM encrypted values\r\n *\r\n * Supports both:\r\n * - userDecrypt: User-initiated decryption with EIP-712 signature\r\n * - publicDecrypt: Public decryption without signature\r\n *\r\n * Usage:\r\n * ```typescript\r\n * const service = new DecryptionService(signer);\r\n * const result = await service.decrypt({\r\n *   contractAddress: '0x...',\r\n *   ciphertext: '0x...',\r\n *   userAddress: '0x...'\r\n * });\r\n * ```\r\n */\r\nexport class DecryptionService {\r\n  private signer: Signer;\r\n  private gatewayUrl?: string;\r\n\r\n  constructor(signer: Signer, gatewayUrl?: string) {\r\n    this.signer = signer;\r\n    this.gatewayUrl = gatewayUrl || 'https://gateway.zama.ai';\r\n  }\r\n\r\n  /**\r\n   * Decrypt a value with user signature (userDecrypt)\r\n   */\r\n  async decrypt<T = any>(params: DecryptionParams): Promise<DecryptionResult<T>> {\r\n    const { contractAddress, ciphertext, userAddress } = params;\r\n\r\n    try {\r\n      // Create EIP-712 signature for decryption request\r\n      const signature = await this.createDecryptionSignature(\r\n        contractAddress,\r\n        ciphertext,\r\n        userAddress\r\n      );\r\n\r\n      // Send decryption request to gateway\r\n      const result = await this.requestDecryption(\r\n        contractAddress,\r\n        ciphertext,\r\n        signature\r\n      );\r\n\r\n      return {\r\n        value: result,\r\n        signature,\r\n      };\r\n    } catch (error) {\r\n      console.error('Decryption failed:', error);\r\n      throw new Error(`Failed to decrypt value: ${error}`);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Public decryption without signature\r\n   */\r\n  async publicDecrypt<T = any>(\r\n    contractAddress: string,\r\n    ciphertext: bigint | string\r\n  ): Promise<T> {\r\n    try {\r\n      const response = await fetch(`${this.gatewayUrl}/publicDecrypt`, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify({\r\n          contractAddress,\r\n          ciphertext: typeof ciphertext === 'bigint' ? ciphertext.toString() : ciphertext,\r\n        }),\r\n      });\r\n\r\n      if (!response.ok) {\r\n        throw new Error(`Gateway returned ${response.status}`);\r\n      }\r\n\r\n      const data = await response.json();\r\n      return data.value;\r\n    } catch (error) {\r\n      console.error('Public decryption failed:', error);\r\n      throw new Error(`Failed to publicly decrypt value: ${error}`);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Decrypt boolean value\r\n   */\r\n  async decryptBool(params: DecryptionParams): Promise<boolean> {\r\n    const result = await this.decrypt<number>(params);\r\n    return result.value === 1;\r\n  }\r\n\r\n  /**\r\n   * Decrypt uint8 value\r\n   */\r\n  async decryptUint8(params: DecryptionParams): Promise<number> {\r\n    const result = await this.decrypt<number>(params);\r\n    return result.value;\r\n  }\r\n\r\n  /**\r\n   * Decrypt uint16 value\r\n   */\r\n  async decryptUint16(params: DecryptionParams): Promise<number> {\r\n    const result = await this.decrypt<number>(params);\r\n    return result.value;\r\n  }\r\n\r\n  /**\r\n   * Decrypt uint32 value\r\n   */\r\n  async decryptUint32(params: DecryptionParams): Promise<number> {\r\n    const result = await this.decrypt<number>(params);\r\n    return result.value;\r\n  }\r\n\r\n  /**\r\n   * Decrypt uint64 value\r\n   */\r\n  async decryptUint64(params: DecryptionParams): Promise<bigint> {\r\n    const result = await this.decrypt<string>(params);\r\n    return BigInt(result.value);\r\n  }\r\n\r\n  /**\r\n   * Create EIP-712 signature for decryption\r\n   */\r\n  private async createDecryptionSignature(\r\n    contractAddress: string,\r\n    ciphertext: bigint | string,\r\n    userAddress: string\r\n  ): Promise<string> {\r\n    const chainId = await this.signer.provider?.getNetwork().then((n) => Number(n.chainId));\r\n\r\n    if (!chainId) {\r\n      throw new Error('Could not determine chain ID');\r\n    }\r\n\r\n    const domain: EIP712Domain = {\r\n      name: 'FHEVM',\r\n      version: '1',\r\n      chainId,\r\n      verifyingContract: contractAddress,\r\n    };\r\n\r\n    const types = {\r\n      Decryption: [\r\n        { name: 'ciphertext', type: 'uint256' },\r\n        { name: 'requester', type: 'address' },\r\n      ],\r\n    };\r\n\r\n    const value = {\r\n      ciphertext: typeof ciphertext === 'bigint' ? ciphertext.toString() : ciphertext,\r\n      requester: userAddress,\r\n    };\r\n\r\n    try {\r\n      // Sign using EIP-712\r\n      const signature = await this.signer.signTypedData(domain, types, value);\r\n      return signature;\r\n    } catch (error) {\r\n      console.error('Failed to create signature:', error);\r\n      throw new Error(`Signature creation failed: ${error}`);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Request decryption from gateway\r\n   */\r\n  private async requestDecryption(\r\n    contractAddress: string,\r\n    ciphertext: bigint | string,\r\n    signature: string\r\n  ): Promise<any> {\r\n    try {\r\n      const response = await fetch(`${this.gatewayUrl}/decrypt`, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify({\r\n          contractAddress,\r\n          ciphertext: typeof ciphertext === 'bigint' ? ciphertext.toString() : ciphertext,\r\n          signature,\r\n        }),\r\n      });\r\n\r\n      if (!response.ok) {\r\n        throw new Error(`Gateway returned ${response.status}: ${await response.text()}`);\r\n      }\r\n\r\n      const data = await response.json();\r\n      return data.value;\r\n    } catch (error) {\r\n      console.error('Gateway request failed:', error);\r\n      throw error;\r\n    }\r\n  }\r\n}\r\n","import { Contract, type Signer } from 'ethers';\r\nimport type { ContractConfig } from '../types';\r\n\r\n/**\r\n * Service for interacting with FHEVM contracts\r\n *\r\n * Usage:\r\n * ```typescript\r\n * const service = new ContractService({\r\n *   address: '0x...',\r\n *   abi: [...],\r\n *   signer\r\n * });\r\n *\r\n * const tx = await service.call('functionName', [arg1, arg2]);\r\n * ```\r\n */\r\nexport class ContractService {\r\n  private contract: Contract;\r\n  private config: ContractConfig;\r\n\r\n  constructor(config: ContractConfig) {\r\n    this.config = config;\r\n    this.contract = new Contract(config.address, config.abi, config.signer);\r\n  }\r\n\r\n  /**\r\n   * Get the underlying ethers Contract instance\r\n   */\r\n  getContract(): Contract {\r\n    return this.contract;\r\n  }\r\n\r\n  /**\r\n   * Get contract address\r\n   */\r\n  getAddress(): string {\r\n    return this.config.address;\r\n  }\r\n\r\n  /**\r\n   * Call a contract method (read-only)\r\n   */\r\n  async read<T = any>(method: string, args: any[] = []): Promise<T> {\r\n    try {\r\n      const result = await this.contract[method](...args);\r\n      return result;\r\n    } catch (error) {\r\n      console.error(`Failed to call ${method}:`, error);\r\n      throw new Error(`Contract read failed: ${error}`);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Send a transaction to a contract method\r\n   */\r\n  async write(method: string, args: any[] = [], overrides?: any) {\r\n    try {\r\n      const tx = await this.contract[method](...args, overrides || {});\r\n      return tx;\r\n    } catch (error) {\r\n      console.error(`Failed to send transaction ${method}:`, error);\r\n      throw new Error(`Contract write failed: ${error}`);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Wait for a transaction to be mined\r\n   */\r\n  async waitForTransaction(txHash: string, confirmations: number = 1) {\r\n    try {\r\n      const receipt = await this.contract.runner?.provider?.waitForTransaction(\r\n        txHash,\r\n        confirmations\r\n      );\r\n      return receipt;\r\n    } catch (error) {\r\n      console.error('Failed to wait for transaction:', error);\r\n      throw new Error(`Transaction wait failed: ${error}`);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Estimate gas for a transaction\r\n   */\r\n  async estimateGas(method: string, args: any[] = []): Promise<bigint> {\r\n    try {\r\n      const gas = await this.contract[method].estimateGas(...args);\r\n      return gas;\r\n    } catch (error) {\r\n      console.error(`Failed to estimate gas for ${method}:`, error);\r\n      throw new Error(`Gas estimation failed: ${error}`);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Listen to contract events\r\n   */\r\n  on(event: string, listener: (...args: any[]) => void): void {\r\n    this.contract.on(event, listener);\r\n  }\r\n\r\n  /**\r\n   * Remove event listener\r\n   */\r\n  off(event: string, listener: (...args: any[]) => void): void {\r\n    this.contract.off(event, listener);\r\n  }\r\n\r\n  /**\r\n   * Query past events\r\n   */\r\n  async queryFilter(event: string, fromBlock?: number, toBlock?: number) {\r\n    try {\r\n      const filter = this.contract.filters[event]();\r\n      const events = await this.contract.queryFilter(filter, fromBlock, toBlock);\r\n      return events;\r\n    } catch (error) {\r\n      console.error(`Failed to query events for ${event}:`, error);\r\n      throw new Error(`Event query failed: ${error}`);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Connect contract to a different signer\r\n   */\r\n  connect(signer: Signer): ContractService {\r\n    return new ContractService({\r\n      ...this.config,\r\n      signer,\r\n    });\r\n  }\r\n}\r\n","/**\r\n * Utility functions for FHEVM SDK\r\n */\r\n\r\nimport { BrowserProvider, JsonRpcProvider, type Signer } from 'ethers';\r\nimport { FhevmClient } from '../core/FhevmClient';\r\nimport { EncryptionService } from '../core/EncryptionService';\r\nimport { DecryptionService } from '../core/DecryptionService';\r\nimport { ContractService } from '../core/ContractService';\r\nimport type { FhevmConfig, ContractConfig } from '../types';\r\n\r\n/**\r\n * Create a new FHEVM client instance\r\n */\r\nexport async function createFhevmClient(\r\n  provider: BrowserProvider | JsonRpcProvider,\r\n  options?: Partial<FhevmConfig>\r\n): Promise<FhevmClient> {\r\n  const config: FhevmConfig = {\r\n    provider,\r\n    ...options,\r\n  };\r\n\r\n  const client = new FhevmClient(config);\r\n  await client.init();\r\n\r\n  return client;\r\n}\r\n\r\n/**\r\n * Quick encrypt value utility\r\n */\r\nexport async function encryptValue(\r\n  client: FhevmClient,\r\n  type: 'bool' | 'uint8' | 'uint16' | 'uint32' | 'uint64',\r\n  value: boolean | number | bigint\r\n) {\r\n  const service = new EncryptionService(client);\r\n\r\n  switch (type) {\r\n    case 'bool':\r\n      return service.encryptBool(value as boolean);\r\n    case 'uint8':\r\n      return service.encryptUint8(value as number);\r\n    case 'uint16':\r\n      return service.encryptUint16(value as number);\r\n    case 'uint32':\r\n      return service.encryptUint32(value as number);\r\n    case 'uint64':\r\n      return service.encryptUint64(value as bigint);\r\n    default:\r\n      throw new Error(`Unsupported type: ${type}`);\r\n  }\r\n}\r\n\r\n/**\r\n * Quick decrypt value utility\r\n */\r\nexport async function decryptValue(\r\n  signer: Signer,\r\n  type: 'bool' | 'uint8' | 'uint16' | 'uint32' | 'uint64',\r\n  contractAddress: string,\r\n  ciphertext: bigint | string,\r\n  userAddress: string,\r\n  gatewayUrl?: string\r\n) {\r\n  const service = new DecryptionService(signer, gatewayUrl);\r\n\r\n  const params = {\r\n    contractAddress,\r\n    ciphertext,\r\n    userAddress,\r\n  };\r\n\r\n  switch (type) {\r\n    case 'bool':\r\n      return service.decryptBool(params);\r\n    case 'uint8':\r\n      return service.decryptUint8(params);\r\n    case 'uint16':\r\n      return service.decryptUint16(params);\r\n    case 'uint32':\r\n      return service.decryptUint32(params);\r\n    case 'uint64':\r\n      return service.decryptUint64(params);\r\n    default:\r\n      throw new Error(`Unsupported type: ${type}`);\r\n  }\r\n}\r\n\r\n/**\r\n * Create contract instance\r\n */\r\nexport function getContractInstance(config: ContractConfig): ContractService {\r\n  return new ContractService(config);\r\n}\r\n\r\n/**\r\n * Format Ethereum address\r\n */\r\nexport function formatAddress(address: string, chars: number = 4): string {\r\n  if (!address) return '';\r\n  return `${address.slice(0, chars + 2)}...${address.slice(-chars)}`;\r\n}\r\n\r\n/**\r\n * Parse encrypted input proof\r\n */\r\nexport function parseEncryptedInput(inputProof: string) {\r\n  try {\r\n    return JSON.parse(inputProof);\r\n  } catch (error) {\r\n    console.error('Failed to parse encrypted input:', error);\r\n    return null;\r\n  }\r\n}\r\n\r\n/**\r\n * Validate Ethereum address\r\n */\r\nexport function isValidAddress(address: string): boolean {\r\n  return /^0x[a-fA-F0-9]{40}$/.test(address);\r\n}\r\n\r\n/**\r\n * Convert Wei to Ether\r\n */\r\nexport function fromWei(wei: bigint | string, decimals: number = 18): string {\r\n  const value = typeof wei === 'string' ? BigInt(wei) : wei;\r\n  const divisor = 10n ** BigInt(decimals);\r\n  const quotient = value / divisor;\r\n  const remainder = value % divisor;\r\n  return `${quotient}.${remainder.toString().padStart(decimals, '0')}`;\r\n}\r\n\r\n/**\r\n * Convert Ether to Wei\r\n */\r\nexport function toWei(ether: string | number, decimals: number = 18): bigint {\r\n  const [whole, fraction = ''] = ether.toString().split('.');\r\n  const paddedFraction = fraction.padEnd(decimals, '0').slice(0, decimals);\r\n  return BigInt(whole) * 10n ** BigInt(decimals) + BigInt(paddedFraction);\r\n}\r\n"],"names":["initFhevm","createInstance","Contract"],"mappings":"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"}