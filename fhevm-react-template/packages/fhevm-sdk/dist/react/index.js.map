{"version":3,"file":"index.js","sources":["../../src/core/FhevmClient.ts","../../src/react/FhevmProvider.tsx","../../src/react/useFhevmClient.ts","../../src/core/EncryptionService.ts","../../src/react/useEncryption.ts","../../src/core/DecryptionService.ts","../../src/react/useDecryption.ts","../../src/core/ContractService.ts","../../src/react/useContract.ts","../../src/react/useEncryptedTransaction.ts"],"sourcesContent":["import { createInstance, initFhevm } from 'fhevmjs';\r\nimport type { BrowserProvider, JsonRpcProvider } from 'ethers';\r\nimport type { FhevmConfig, FhevmInstance, NetworkConfig } from '../types';\r\n\r\n/**\r\n * Main FHEVM Client - Framework agnostic\r\n *\r\n * Usage:\r\n * ```typescript\r\n * const client = new FhevmClient({ provider });\r\n * await client.init();\r\n * const encrypted = await client.encrypt32(42);\r\n * ```\r\n */\r\nexport class FhevmClient {\r\n  private instance: FhevmInstance | null = null;\r\n  private provider: BrowserProvider | JsonRpcProvider;\r\n  private network?: NetworkConfig;\r\n  private publicKeyBytes?: Uint8Array;\r\n  private initialized = false;\r\n\r\n  constructor(config: FhevmConfig) {\r\n    this.provider = config.provider;\r\n    this.network = config.network as NetworkConfig;\r\n    // Convert hex string to Uint8Array if provided\r\n    if (config.publicKey) {\r\n      this.publicKeyBytes = this.hexToUint8Array(config.publicKey);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Initialize the FHEVM client\r\n   */\r\n  async init(): Promise<void> {\r\n    if (this.initialized) {\r\n      return;\r\n    }\r\n\r\n    try {\r\n      // Initialize fhevmjs library\r\n      await initFhevm();\r\n\r\n      // Get network information\r\n      const network = await this.provider.getNetwork();\r\n      const chainId = Number(network.chainId);\r\n\r\n      // Prepare config for createInstance\r\n      const config: any = {\r\n        kmsContractAddress: this.network?.aclAddress || '0x',\r\n        aclContractAddress: this.network?.aclAddress || '0x',\r\n        chainId,\r\n      };\r\n\r\n      // Add public key if available\r\n      if (this.publicKeyBytes) {\r\n        config.publicKey = this.publicKeyBytes;\r\n      }\r\n\r\n      // Add gateway URL if available\r\n      if (this.network?.gatewayUrl) {\r\n        config.gatewayUrl = this.network.gatewayUrl;\r\n      }\r\n\r\n      this.instance = await createInstance(config);\r\n\r\n      this.initialized = true;\r\n    } catch (error) {\r\n      console.error('Failed to initialize FHEVM client:', error);\r\n      throw new Error(`FHEVM initialization failed: ${error}`);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get the underlying FHEVM instance\r\n   */\r\n  getInstance(): FhevmInstance {\r\n    if (!this.instance) {\r\n      throw new Error('FHEVM client not initialized. Call init() first.');\r\n    }\r\n    return this.instance;\r\n  }\r\n\r\n  /**\r\n   * Check if client is initialized\r\n   */\r\n  isInitialized(): boolean {\r\n    return this.initialized;\r\n  }\r\n\r\n  /**\r\n   * Get the public key\r\n   */\r\n  getPublicKey(): { publicKeyId: string; publicKey: Uint8Array } | null {\r\n    const instance = this.getInstance();\r\n    return instance.getPublicKey();\r\n  }\r\n\r\n  /**\r\n   * Helper to convert hex string to Uint8Array\r\n   */\r\n  private hexToUint8Array(hex: string): Uint8Array {\r\n    const cleanHex = hex.startsWith('0x') ? hex.slice(2) : hex;\r\n    const bytes = new Uint8Array(cleanHex.length / 2);\r\n    for (let i = 0; i < bytes.length; i++) {\r\n      bytes[i] = parseInt(cleanHex.substr(i * 2, 2), 16);\r\n    }\r\n    return bytes;\r\n  }\r\n\r\n  /**\r\n   * Create encrypted input builder for a contract\r\n   */\r\n  createEncryptedInput(contractAddress: string, userAddress: string) {\r\n    const instance = this.getInstance();\r\n    return instance.createEncryptedInput(contractAddress, userAddress);\r\n  }\r\n\r\n  /**\r\n   * Generate a keypair for reencryption\r\n   */\r\n  generateKeypair() {\r\n    const instance = this.getInstance();\r\n    return instance.generateKeypair();\r\n  }\r\n\r\n  /**\r\n   * Create EIP-712 signature object\r\n   */\r\n  createEIP712(publicKey: string, contractAddress: string, delegatedAccount?: string) {\r\n    const instance = this.getInstance();\r\n    return instance.createEIP712(publicKey, contractAddress, delegatedAccount);\r\n  }\r\n\r\n  /**\r\n   * Reencrypt a value for the user\r\n   */\r\n  async reencrypt(\r\n    handle: bigint,\r\n    privateKey: string,\r\n    publicKey: string,\r\n    signature: string,\r\n    contractAddress: string,\r\n    userAddress: string\r\n  ): Promise<bigint> {\r\n    const instance = this.getInstance();\r\n    return instance.reencrypt(handle, privateKey, publicKey, signature, contractAddress, userAddress);\r\n  }\r\n}\r\n","import React, { createContext, useContext, useEffect, useState, type ReactNode } from 'react';\r\nimport { BrowserProvider } from 'ethers';\r\nimport { FhevmClient } from '../core/FhevmClient';\r\nimport type { FhevmConfig } from '../types';\r\n\r\ninterface FhevmContextValue {\r\n  client: FhevmClient | null;\r\n  isInitialized: boolean;\r\n  error: Error | null;\r\n}\r\n\r\nconst FhevmContext = createContext<FhevmContextValue | undefined>(undefined);\r\n\r\nexport interface FhevmProviderProps {\r\n  children: ReactNode;\r\n  provider?: BrowserProvider;\r\n  config?: Partial<FhevmConfig>;\r\n}\r\n\r\n/**\r\n * Provider component for FHEVM SDK in React applications\r\n *\r\n * Usage:\r\n * ```tsx\r\n * <FhevmProvider provider={provider}>\r\n *   <App />\r\n * </FhevmProvider>\r\n * ```\r\n */\r\nexport function FhevmProvider({ children, provider, config }: FhevmProviderProps) {\r\n  const [client, setClient] = useState<FhevmClient | null>(null);\r\n  const [isInitialized, setIsInitialized] = useState(false);\r\n  const [error, setError] = useState<Error | null>(null);\r\n\r\n  useEffect(() => {\r\n    if (!provider) {\r\n      setClient(null);\r\n      setIsInitialized(false);\r\n      return;\r\n    }\r\n\r\n    const initClient = async () => {\r\n      try {\r\n        const fhevmClient = new FhevmClient({\r\n          provider,\r\n          ...config,\r\n        });\r\n\r\n        await fhevmClient.init();\r\n        setClient(fhevmClient);\r\n        setIsInitialized(true);\r\n        setError(null);\r\n      } catch (err) {\r\n        console.error('Failed to initialize FHEVM client:', err);\r\n        setError(err instanceof Error ? err : new Error('Unknown error'));\r\n        setIsInitialized(false);\r\n      }\r\n    };\r\n\r\n    initClient();\r\n  }, [provider, config]);\r\n\r\n  return (\r\n    <FhevmContext.Provider value={{ client, isInitialized, error }}>\r\n      {children}\r\n    </FhevmContext.Provider>\r\n  );\r\n}\r\n\r\n/**\r\n * Hook to access FHEVM context\r\n */\r\nexport function useFhevmContext() {\r\n  const context = useContext(FhevmContext);\r\n  if (context === undefined) {\r\n    throw new Error('useFhevmContext must be used within FhevmProvider');\r\n  }\r\n  return context;\r\n}\r\n","import { useFhevmContext } from './FhevmProvider';\r\n\r\n/**\r\n * Hook to access FHEVM client instance\r\n *\r\n * Usage:\r\n * ```tsx\r\n * const { client, isInitialized, error } = useFhevmClient();\r\n * ```\r\n */\r\nexport function useFhevmClient() {\r\n  const { client, isInitialized, error } = useFhevmContext();\r\n\r\n  return {\r\n    client,\r\n    isInitialized,\r\n    error,\r\n    isReady: isInitialized && !error,\r\n  };\r\n}\r\n","import type { FhevmClient } from './FhevmClient';\r\nimport type { EncryptedInput, EncryptedData } from '../types';\r\n\r\n/**\r\n * Service for encrypting values using FHEVM\r\n *\r\n * Usage:\r\n * ```typescript\r\n * const service = new EncryptionService(fhevmClient);\r\n * const encrypted = await service.encryptUint32(100);\r\n * ```\r\n */\r\nexport class EncryptionService {\r\n  private client: FhevmClient;\r\n\r\n  constructor(client: FhevmClient) {\r\n    this.client = client;\r\n  }\r\n\r\n  /**\r\n   * Encrypt a single boolean value\r\n   * This is a convenience method that creates a builder with one value\r\n   */\r\n  async encryptBool(\r\n    value: boolean,\r\n    contractAddress: string,\r\n    userAddress: string\r\n  ): Promise<EncryptedData> {\r\n    if (!this.client.isInitialized()) {\r\n      await this.client.init();\r\n    }\r\n    const builder = this.client.createEncryptedInput(contractAddress, userAddress);\r\n    builder.addBool(value);\r\n    return builder.encrypt();\r\n  }\r\n\r\n  /**\r\n   * Encrypt a single 8-bit unsigned integer\r\n   */\r\n  async encryptUint8(\r\n    value: number,\r\n    contractAddress: string,\r\n    userAddress: string\r\n  ): Promise<EncryptedData> {\r\n    this.validateUint(value, 8);\r\n    if (!this.client.isInitialized()) {\r\n      await this.client.init();\r\n    }\r\n    const builder = this.client.createEncryptedInput(contractAddress, userAddress);\r\n    builder.add8(value);\r\n    return builder.encrypt();\r\n  }\r\n\r\n  /**\r\n   * Encrypt a single 16-bit unsigned integer\r\n   */\r\n  async encryptUint16(\r\n    value: number,\r\n    contractAddress: string,\r\n    userAddress: string\r\n  ): Promise<EncryptedData> {\r\n    this.validateUint(value, 16);\r\n    if (!this.client.isInitialized()) {\r\n      await this.client.init();\r\n    }\r\n    const builder = this.client.createEncryptedInput(contractAddress, userAddress);\r\n    builder.add16(value);\r\n    return builder.encrypt();\r\n  }\r\n\r\n  /**\r\n   * Encrypt a single 32-bit unsigned integer\r\n   */\r\n  async encryptUint32(\r\n    value: number,\r\n    contractAddress: string,\r\n    userAddress: string\r\n  ): Promise<EncryptedData> {\r\n    this.validateUint(value, 32);\r\n    if (!this.client.isInitialized()) {\r\n      await this.client.init();\r\n    }\r\n    const builder = this.client.createEncryptedInput(contractAddress, userAddress);\r\n    builder.add32(value);\r\n    return builder.encrypt();\r\n  }\r\n\r\n  /**\r\n   * Encrypt a single 64-bit unsigned integer\r\n   */\r\n  async encryptUint64(\r\n    value: bigint,\r\n    contractAddress: string,\r\n    userAddress: string\r\n  ): Promise<EncryptedData> {\r\n    this.validateUint64(value);\r\n    if (!this.client.isInitialized()) {\r\n      await this.client.init();\r\n    }\r\n    const builder = this.client.createEncryptedInput(contractAddress, userAddress);\r\n    builder.add64(value);\r\n    return builder.encrypt();\r\n  }\r\n\r\n  /**\r\n   * Create an encrypted input builder for batch encryption\r\n   */\r\n  createEncryptedInputBuilder(contractAddress: string, userAddress: string) {\r\n    if (!this.client.isInitialized()) {\r\n      throw new Error('Client not initialized');\r\n    }\r\n    return this.client.createEncryptedInput(contractAddress, userAddress);\r\n  }\r\n\r\n  /**\r\n   * Encrypt multiple values at once\r\n   */\r\n  async encryptBatch(\r\n    contractAddress: string,\r\n    userAddress: string,\r\n    values: Array<{\r\n      type: 'bool' | 'uint8' | 'uint16' | 'uint32' | 'uint64' | 'address';\r\n      value: boolean | number | bigint | string;\r\n    }>\r\n  ): Promise<EncryptedData> {\r\n    if (!this.client.isInitialized()) {\r\n      await this.client.init();\r\n    }\r\n\r\n    const builder = this.createEncryptedInputBuilder(contractAddress, userAddress);\r\n\r\n    for (const { type, value } of values) {\r\n      switch (type) {\r\n        case 'bool':\r\n          builder.addBool(value as boolean);\r\n          break;\r\n        case 'uint8':\r\n          builder.add8(value as number);\r\n          break;\r\n        case 'uint16':\r\n          builder.add16(value as number);\r\n          break;\r\n        case 'uint32':\r\n          builder.add32(value as number);\r\n          break;\r\n        case 'uint64':\r\n          builder.add64(value as bigint);\r\n          break;\r\n        case 'address':\r\n          builder.addAddress(value as string);\r\n          break;\r\n        default:\r\n          throw new Error(`Unsupported type: ${type}`);\r\n      }\r\n    }\r\n\r\n    return builder.encrypt();\r\n  }\r\n\r\n  /**\r\n   * Validate unsigned integer value\r\n   */\r\n  private validateUint(value: number, bits: 8 | 16 | 32): void {\r\n    if (!Number.isInteger(value)) {\r\n      throw new Error('Value must be an integer');\r\n    }\r\n    if (value < 0) {\r\n      throw new Error('Value must be non-negative');\r\n    }\r\n    const max = 2 ** bits - 1;\r\n    if (value > max) {\r\n      throw new Error(`Value exceeds maximum for uint${bits}: ${max}`);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Validate 64-bit unsigned integer\r\n   */\r\n  private validateUint64(value: bigint): void {\r\n    if (value < 0n) {\r\n      throw new Error('Value must be non-negative');\r\n    }\r\n    const max = 2n ** 64n - 1n;\r\n    if (value > max) {\r\n      throw new Error(`Value exceeds maximum for uint64: ${max}`);\r\n    }\r\n  }\r\n}\r\n","import { useState, useCallback } from 'react';\r\nimport { EncryptionService } from '../core/EncryptionService';\r\nimport { useFhevmClient } from './useFhevmClient';\r\nimport type { EncryptedInput, EncryptedData } from '../types';\r\n\r\n/**\r\n * Hook for encrypting values with FHEVM\r\n *\r\n * Usage:\r\n * ```tsx\r\n * const { encrypt, encryptBatch, isEncrypting, error } = useEncryption();\r\n *\r\n * const handleEncrypt = async () => {\r\n *   const encrypted = await encrypt('uint32', 100);\r\n * };\r\n * ```\r\n */\r\nexport function useEncryption() {\r\n  const { client, isReady } = useFhevmClient();\r\n  const [isEncrypting, setIsEncrypting] = useState(false);\r\n  const [error, setError] = useState<Error | null>(null);\r\n\r\n  const encrypt = useCallback(\r\n    async (\r\n      type: 'bool' | 'uint8' | 'uint16' | 'uint32' | 'uint64',\r\n      value: boolean | number | bigint\r\n    ): Promise<EncryptedInput | null> => {\r\n      if (!client || !isReady) {\r\n        setError(new Error('FHEVM client not ready'));\r\n        return null;\r\n      }\r\n\r\n      setIsEncrypting(true);\r\n      setError(null);\r\n\r\n      try {\r\n        const service = new EncryptionService(client);\r\n\r\n        let result: EncryptedInput;\r\n        switch (type) {\r\n          case 'bool':\r\n            result = await service.encryptBool(value as boolean);\r\n            break;\r\n          case 'uint8':\r\n            result = await service.encryptUint8(value as number);\r\n            break;\r\n          case 'uint16':\r\n            result = await service.encryptUint16(value as number);\r\n            break;\r\n          case 'uint32':\r\n            result = await service.encryptUint32(value as number);\r\n            break;\r\n          case 'uint64':\r\n            result = await service.encryptUint64(value as bigint);\r\n            break;\r\n          default:\r\n            throw new Error(`Unsupported type: ${type}`);\r\n        }\r\n\r\n        return result;\r\n      } catch (err) {\r\n        const error = err instanceof Error ? err : new Error('Encryption failed');\r\n        setError(error);\r\n        return null;\r\n      } finally {\r\n        setIsEncrypting(false);\r\n      }\r\n    },\r\n    [client, isReady]\r\n  );\r\n\r\n  const encryptBatch = useCallback(\r\n    async (\r\n      contractAddress: string,\r\n      userAddress: string,\r\n      values: Array<{\r\n        type: 'bool' | 'uint8' | 'uint16' | 'uint32' | 'uint64' | 'address';\r\n        value: boolean | number | bigint | string;\r\n      }>\r\n    ): Promise<EncryptedData | null> => {\r\n      if (!client || !isReady) {\r\n        setError(new Error('FHEVM client not ready'));\r\n        return null;\r\n      }\r\n\r\n      setIsEncrypting(true);\r\n      setError(null);\r\n\r\n      try {\r\n        const service = new EncryptionService(client);\r\n        const result = await service.encryptBatch(contractAddress, userAddress, values);\r\n        return result;\r\n      } catch (err) {\r\n        const error = err instanceof Error ? err : new Error('Batch encryption failed');\r\n        setError(error);\r\n        return null;\r\n      } finally {\r\n        setIsEncrypting(false);\r\n      }\r\n    },\r\n    [client, isReady]\r\n  );\r\n\r\n  const encryptBool = useCallback(\r\n    (value: boolean) => encrypt('bool', value),\r\n    [encrypt]\r\n  );\r\n\r\n  const encryptUint8 = useCallback(\r\n    (value: number) => encrypt('uint8', value),\r\n    [encrypt]\r\n  );\r\n\r\n  const encryptUint16 = useCallback(\r\n    (value: number) => encrypt('uint16', value),\r\n    [encrypt]\r\n  );\r\n\r\n  const encryptUint32 = useCallback(\r\n    (value: number) => encrypt('uint32', value),\r\n    [encrypt]\r\n  );\r\n\r\n  const encryptUint64 = useCallback(\r\n    (value: bigint) => encrypt('uint64', value),\r\n    [encrypt]\r\n  );\r\n\r\n  return {\r\n    encrypt,\r\n    encryptBatch,\r\n    encryptBool,\r\n    encryptUint8,\r\n    encryptUint16,\r\n    encryptUint32,\r\n    encryptUint64,\r\n    isEncrypting,\r\n    error,\r\n  };\r\n}\r\n","import type { Signer } from 'ethers';\r\nimport type { DecryptionParams, DecryptionResult, EIP712Domain } from '../types';\r\n\r\n/**\r\n * Service for decrypting FHEVM encrypted values\r\n *\r\n * Supports both:\r\n * - userDecrypt: User-initiated decryption with EIP-712 signature\r\n * - publicDecrypt: Public decryption without signature\r\n *\r\n * Usage:\r\n * ```typescript\r\n * const service = new DecryptionService(signer);\r\n * const result = await service.decrypt({\r\n *   contractAddress: '0x...',\r\n *   ciphertext: '0x...',\r\n *   userAddress: '0x...'\r\n * });\r\n * ```\r\n */\r\nexport class DecryptionService {\r\n  private signer: Signer;\r\n  private gatewayUrl?: string;\r\n\r\n  constructor(signer: Signer, gatewayUrl?: string) {\r\n    this.signer = signer;\r\n    this.gatewayUrl = gatewayUrl || 'https://gateway.zama.ai';\r\n  }\r\n\r\n  /**\r\n   * Decrypt a value with user signature (userDecrypt)\r\n   */\r\n  async decrypt<T = any>(params: DecryptionParams): Promise<DecryptionResult<T>> {\r\n    const { contractAddress, ciphertext, userAddress } = params;\r\n\r\n    try {\r\n      // Create EIP-712 signature for decryption request\r\n      const signature = await this.createDecryptionSignature(\r\n        contractAddress,\r\n        ciphertext,\r\n        userAddress\r\n      );\r\n\r\n      // Send decryption request to gateway\r\n      const result = await this.requestDecryption(\r\n        contractAddress,\r\n        ciphertext,\r\n        signature\r\n      );\r\n\r\n      return {\r\n        value: result,\r\n        signature,\r\n      };\r\n    } catch (error) {\r\n      console.error('Decryption failed:', error);\r\n      throw new Error(`Failed to decrypt value: ${error}`);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Public decryption without signature\r\n   */\r\n  async publicDecrypt<T = any>(\r\n    contractAddress: string,\r\n    ciphertext: bigint | string\r\n  ): Promise<T> {\r\n    try {\r\n      const response = await fetch(`${this.gatewayUrl}/publicDecrypt`, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify({\r\n          contractAddress,\r\n          ciphertext: typeof ciphertext === 'bigint' ? ciphertext.toString() : ciphertext,\r\n        }),\r\n      });\r\n\r\n      if (!response.ok) {\r\n        throw new Error(`Gateway returned ${response.status}`);\r\n      }\r\n\r\n      const data = await response.json();\r\n      return data.value;\r\n    } catch (error) {\r\n      console.error('Public decryption failed:', error);\r\n      throw new Error(`Failed to publicly decrypt value: ${error}`);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Decrypt boolean value\r\n   */\r\n  async decryptBool(params: DecryptionParams): Promise<boolean> {\r\n    const result = await this.decrypt<number>(params);\r\n    return result.value === 1;\r\n  }\r\n\r\n  /**\r\n   * Decrypt uint8 value\r\n   */\r\n  async decryptUint8(params: DecryptionParams): Promise<number> {\r\n    const result = await this.decrypt<number>(params);\r\n    return result.value;\r\n  }\r\n\r\n  /**\r\n   * Decrypt uint16 value\r\n   */\r\n  async decryptUint16(params: DecryptionParams): Promise<number> {\r\n    const result = await this.decrypt<number>(params);\r\n    return result.value;\r\n  }\r\n\r\n  /**\r\n   * Decrypt uint32 value\r\n   */\r\n  async decryptUint32(params: DecryptionParams): Promise<number> {\r\n    const result = await this.decrypt<number>(params);\r\n    return result.value;\r\n  }\r\n\r\n  /**\r\n   * Decrypt uint64 value\r\n   */\r\n  async decryptUint64(params: DecryptionParams): Promise<bigint> {\r\n    const result = await this.decrypt<string>(params);\r\n    return BigInt(result.value);\r\n  }\r\n\r\n  /**\r\n   * Create EIP-712 signature for decryption\r\n   */\r\n  private async createDecryptionSignature(\r\n    contractAddress: string,\r\n    ciphertext: bigint | string,\r\n    userAddress: string\r\n  ): Promise<string> {\r\n    const chainId = await this.signer.provider?.getNetwork().then((n) => Number(n.chainId));\r\n\r\n    if (!chainId) {\r\n      throw new Error('Could not determine chain ID');\r\n    }\r\n\r\n    const domain: EIP712Domain = {\r\n      name: 'FHEVM',\r\n      version: '1',\r\n      chainId,\r\n      verifyingContract: contractAddress,\r\n    };\r\n\r\n    const types = {\r\n      Decryption: [\r\n        { name: 'ciphertext', type: 'uint256' },\r\n        { name: 'requester', type: 'address' },\r\n      ],\r\n    };\r\n\r\n    const value = {\r\n      ciphertext: typeof ciphertext === 'bigint' ? ciphertext.toString() : ciphertext,\r\n      requester: userAddress,\r\n    };\r\n\r\n    try {\r\n      // Sign using EIP-712\r\n      const signature = await this.signer.signTypedData(domain, types, value);\r\n      return signature;\r\n    } catch (error) {\r\n      console.error('Failed to create signature:', error);\r\n      throw new Error(`Signature creation failed: ${error}`);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Request decryption from gateway\r\n   */\r\n  private async requestDecryption(\r\n    contractAddress: string,\r\n    ciphertext: bigint | string,\r\n    signature: string\r\n  ): Promise<any> {\r\n    try {\r\n      const response = await fetch(`${this.gatewayUrl}/decrypt`, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify({\r\n          contractAddress,\r\n          ciphertext: typeof ciphertext === 'bigint' ? ciphertext.toString() : ciphertext,\r\n          signature,\r\n        }),\r\n      });\r\n\r\n      if (!response.ok) {\r\n        throw new Error(`Gateway returned ${response.status}: ${await response.text()}`);\r\n      }\r\n\r\n      const data = await response.json();\r\n      return data.value;\r\n    } catch (error) {\r\n      console.error('Gateway request failed:', error);\r\n      throw error;\r\n    }\r\n  }\r\n}\r\n","import { useState, useCallback } from 'react';\r\nimport type { Signer } from 'ethers';\r\nimport { DecryptionService } from '../core/DecryptionService';\r\nimport type { DecryptionParams } from '../types';\r\n\r\n/**\r\n * Hook for decrypting FHEVM encrypted values\r\n *\r\n * Usage:\r\n * ```tsx\r\n * const { decrypt, isDecrypting, error } = useDecryption(signer);\r\n *\r\n * const handleDecrypt = async () => {\r\n *   const value = await decrypt('uint32', {\r\n *     contractAddress: '0x...',\r\n *     ciphertext: '0x...',\r\n *     userAddress: '0x...'\r\n *   });\r\n * };\r\n * ```\r\n */\r\nexport function useDecryption(signer?: Signer, gatewayUrl?: string) {\r\n  const [isDecrypting, setIsDecrypting] = useState(false);\r\n  const [error, setError] = useState<Error | null>(null);\r\n\r\n  const decrypt = useCallback(\r\n    async <T = any>(\r\n      type: 'bool' | 'uint8' | 'uint16' | 'uint32' | 'uint64',\r\n      params: DecryptionParams\r\n    ): Promise<T | null> => {\r\n      if (!signer) {\r\n        setError(new Error('Signer not provided'));\r\n        return null;\r\n      }\r\n\r\n      setIsDecrypting(true);\r\n      setError(null);\r\n\r\n      try {\r\n        const service = new DecryptionService(signer, gatewayUrl);\r\n\r\n        let result: any;\r\n        switch (type) {\r\n          case 'bool':\r\n            result = await service.decryptBool(params);\r\n            break;\r\n          case 'uint8':\r\n            result = await service.decryptUint8(params);\r\n            break;\r\n          case 'uint16':\r\n            result = await service.decryptUint16(params);\r\n            break;\r\n          case 'uint32':\r\n            result = await service.decryptUint32(params);\r\n            break;\r\n          case 'uint64':\r\n            result = await service.decryptUint64(params);\r\n            break;\r\n          default:\r\n            throw new Error(`Unsupported type: ${type}`);\r\n        }\r\n\r\n        return result;\r\n      } catch (err) {\r\n        const error = err instanceof Error ? err : new Error('Decryption failed');\r\n        setError(error);\r\n        return null;\r\n      } finally {\r\n        setIsDecrypting(false);\r\n      }\r\n    },\r\n    [signer, gatewayUrl]\r\n  );\r\n\r\n  const publicDecrypt = useCallback(\r\n    async <T = any>(contractAddress: string, ciphertext: bigint | string): Promise<T | null> => {\r\n      if (!signer) {\r\n        setError(new Error('Signer not provided'));\r\n        return null;\r\n      }\r\n\r\n      setIsDecrypting(true);\r\n      setError(null);\r\n\r\n      try {\r\n        const service = new DecryptionService(signer, gatewayUrl);\r\n        const result = await service.publicDecrypt<T>(contractAddress, ciphertext);\r\n        return result;\r\n      } catch (err) {\r\n        const error = err instanceof Error ? err : new Error('Public decryption failed');\r\n        setError(error);\r\n        return null;\r\n      } finally {\r\n        setIsDecrypting(false);\r\n      }\r\n    },\r\n    [signer, gatewayUrl]\r\n  );\r\n\r\n  const decryptBool = useCallback(\r\n    (params: DecryptionParams) => decrypt<boolean>('bool', params),\r\n    [decrypt]\r\n  );\r\n\r\n  const decryptUint8 = useCallback(\r\n    (params: DecryptionParams) => decrypt<number>('uint8', params),\r\n    [decrypt]\r\n  );\r\n\r\n  const decryptUint16 = useCallback(\r\n    (params: DecryptionParams) => decrypt<number>('uint16', params),\r\n    [decrypt]\r\n  );\r\n\r\n  const decryptUint32 = useCallback(\r\n    (params: DecryptionParams) => decrypt<number>('uint32', params),\r\n    [decrypt]\r\n  );\r\n\r\n  const decryptUint64 = useCallback(\r\n    (params: DecryptionParams) => decrypt<bigint>('uint64', params),\r\n    [decrypt]\r\n  );\r\n\r\n  return {\r\n    decrypt,\r\n    publicDecrypt,\r\n    decryptBool,\r\n    decryptUint8,\r\n    decryptUint16,\r\n    decryptUint32,\r\n    decryptUint64,\r\n    isDecrypting,\r\n    error,\r\n  };\r\n}\r\n","import { Contract, type Signer } from 'ethers';\r\nimport type { ContractConfig } from '../types';\r\n\r\n/**\r\n * Service for interacting with FHEVM contracts\r\n *\r\n * Usage:\r\n * ```typescript\r\n * const service = new ContractService({\r\n *   address: '0x...',\r\n *   abi: [...],\r\n *   signer\r\n * });\r\n *\r\n * const tx = await service.call('functionName', [arg1, arg2]);\r\n * ```\r\n */\r\nexport class ContractService {\r\n  private contract: Contract;\r\n  private config: ContractConfig;\r\n\r\n  constructor(config: ContractConfig) {\r\n    this.config = config;\r\n    this.contract = new Contract(config.address, config.abi, config.signer);\r\n  }\r\n\r\n  /**\r\n   * Get the underlying ethers Contract instance\r\n   */\r\n  getContract(): Contract {\r\n    return this.contract;\r\n  }\r\n\r\n  /**\r\n   * Get contract address\r\n   */\r\n  getAddress(): string {\r\n    return this.config.address;\r\n  }\r\n\r\n  /**\r\n   * Call a contract method (read-only)\r\n   */\r\n  async read<T = any>(method: string, args: any[] = []): Promise<T> {\r\n    try {\r\n      const result = await this.contract[method](...args);\r\n      return result;\r\n    } catch (error) {\r\n      console.error(`Failed to call ${method}:`, error);\r\n      throw new Error(`Contract read failed: ${error}`);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Send a transaction to a contract method\r\n   */\r\n  async write(method: string, args: any[] = [], overrides?: any) {\r\n    try {\r\n      const tx = await this.contract[method](...args, overrides || {});\r\n      return tx;\r\n    } catch (error) {\r\n      console.error(`Failed to send transaction ${method}:`, error);\r\n      throw new Error(`Contract write failed: ${error}`);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Wait for a transaction to be mined\r\n   */\r\n  async waitForTransaction(txHash: string, confirmations: number = 1) {\r\n    try {\r\n      const receipt = await this.contract.runner?.provider?.waitForTransaction(\r\n        txHash,\r\n        confirmations\r\n      );\r\n      return receipt;\r\n    } catch (error) {\r\n      console.error('Failed to wait for transaction:', error);\r\n      throw new Error(`Transaction wait failed: ${error}`);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Estimate gas for a transaction\r\n   */\r\n  async estimateGas(method: string, args: any[] = []): Promise<bigint> {\r\n    try {\r\n      const gas = await this.contract[method].estimateGas(...args);\r\n      return gas;\r\n    } catch (error) {\r\n      console.error(`Failed to estimate gas for ${method}:`, error);\r\n      throw new Error(`Gas estimation failed: ${error}`);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Listen to contract events\r\n   */\r\n  on(event: string, listener: (...args: any[]) => void): void {\r\n    this.contract.on(event, listener);\r\n  }\r\n\r\n  /**\r\n   * Remove event listener\r\n   */\r\n  off(event: string, listener: (...args: any[]) => void): void {\r\n    this.contract.off(event, listener);\r\n  }\r\n\r\n  /**\r\n   * Query past events\r\n   */\r\n  async queryFilter(event: string, fromBlock?: number, toBlock?: number) {\r\n    try {\r\n      const filter = this.contract.filters[event]();\r\n      const events = await this.contract.queryFilter(filter, fromBlock, toBlock);\r\n      return events;\r\n    } catch (error) {\r\n      console.error(`Failed to query events for ${event}:`, error);\r\n      throw new Error(`Event query failed: ${error}`);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Connect contract to a different signer\r\n   */\r\n  connect(signer: Signer): ContractService {\r\n    return new ContractService({\r\n      ...this.config,\r\n      signer,\r\n    });\r\n  }\r\n}\r\n","import { useState, useCallback, useEffect } from 'react';\r\nimport type { Signer } from 'ethers';\r\nimport { ContractService } from '../core/ContractService';\r\nimport type { ContractConfig } from '../types';\r\n\r\n/**\r\n * Hook for interacting with FHEVM contracts\r\n *\r\n * Usage:\r\n * ```tsx\r\n * const { contract, read, write, isLoading, error } = useContract({\r\n *   address: '0x...',\r\n *   abi: [...],\r\n *   signer\r\n * });\r\n *\r\n * const result = await read('balanceOf', [address]);\r\n * const tx = await write('transfer', [to, amount]);\r\n * ```\r\n */\r\nexport function useContract(config: ContractConfig) {\r\n  const [contract, setContract] = useState<ContractService | null>(null);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [error, setError] = useState<Error | null>(null);\r\n\r\n  useEffect(() => {\r\n    try {\r\n      const contractService = new ContractService(config);\r\n      setContract(contractService);\r\n      setError(null);\r\n    } catch (err) {\r\n      const error = err instanceof Error ? err : new Error('Failed to create contract');\r\n      setError(error);\r\n      setContract(null);\r\n    }\r\n  }, [config.address, config.abi, config.signer]);\r\n\r\n  const read = useCallback(\r\n    async <T = any>(method: string, args: any[] = []): Promise<T | null> => {\r\n      if (!contract) {\r\n        setError(new Error('Contract not initialized'));\r\n        return null;\r\n      }\r\n\r\n      setIsLoading(true);\r\n      setError(null);\r\n\r\n      try {\r\n        const result = await contract.read<T>(method, args);\r\n        return result;\r\n      } catch (err) {\r\n        const error = err instanceof Error ? err : new Error('Contract read failed');\r\n        setError(error);\r\n        return null;\r\n      } finally {\r\n        setIsLoading(false);\r\n      }\r\n    },\r\n    [contract]\r\n  );\r\n\r\n  const write = useCallback(\r\n    async (method: string, args: any[] = [], overrides?: any) => {\r\n      if (!contract) {\r\n        setError(new Error('Contract not initialized'));\r\n        return null;\r\n      }\r\n\r\n      setIsLoading(true);\r\n      setError(null);\r\n\r\n      try {\r\n        const tx = await contract.write(method, args, overrides);\r\n        return tx;\r\n      } catch (err) {\r\n        const error = err instanceof Error ? err : new Error('Transaction failed');\r\n        setError(error);\r\n        return null;\r\n      } finally {\r\n        setIsLoading(false);\r\n      }\r\n    },\r\n    [contract]\r\n  );\r\n\r\n  const estimateGas = useCallback(\r\n    async (method: string, args: any[] = []): Promise<bigint | null> => {\r\n      if (!contract) {\r\n        setError(new Error('Contract not initialized'));\r\n        return null;\r\n      }\r\n\r\n      try {\r\n        const gas = await contract.estimateGas(method, args);\r\n        return gas;\r\n      } catch (err) {\r\n        const error = err instanceof Error ? err : new Error('Gas estimation failed');\r\n        setError(error);\r\n        return null;\r\n      }\r\n    },\r\n    [contract]\r\n  );\r\n\r\n  const on = useCallback(\r\n    (event: string, listener: (...args: any[]) => void) => {\r\n      if (contract) {\r\n        contract.on(event, listener);\r\n      }\r\n    },\r\n    [contract]\r\n  );\r\n\r\n  const off = useCallback(\r\n    (event: string, listener: (...args: any[]) => void) => {\r\n      if (contract) {\r\n        contract.off(event, listener);\r\n      }\r\n    },\r\n    [contract]\r\n  );\r\n\r\n  return {\r\n    contract,\r\n    read,\r\n    write,\r\n    estimateGas,\r\n    on,\r\n    off,\r\n    isLoading,\r\n    error,\r\n  };\r\n}\r\n","import { useState, useCallback } from 'react';\r\nimport type { Signer } from 'ethers';\r\nimport { EncryptionService } from '../core/EncryptionService';\r\nimport { ContractService } from '../core/ContractService';\r\nimport { useFhevmClient } from './useFhevmClient';\r\nimport type { ContractConfig } from '../types';\r\n\r\ninterface EncryptedTransactionParams {\r\n  method: string;\r\n  encryptedInputs: Array<{\r\n    type: 'bool' | 'uint8' | 'uint16' | 'uint32' | 'uint64' | 'address';\r\n    value: boolean | number | bigint | string;\r\n  }>;\r\n  additionalArgs?: any[];\r\n  overrides?: any;\r\n}\r\n\r\n/**\r\n * Hook for sending encrypted transactions to FHEVM contracts\r\n *\r\n * Usage:\r\n * ```tsx\r\n * const { sendEncryptedTransaction, isLoading, error } = useEncryptedTransaction({\r\n *   address: '0x...',\r\n *   abi: [...],\r\n *   signer\r\n * });\r\n *\r\n * const tx = await sendEncryptedTransaction({\r\n *   method: 'placeBet',\r\n *   encryptedInputs: [\r\n *     { type: 'uint32', value: 100 },\r\n *     { type: 'bool', value: true }\r\n *   ],\r\n *   additionalArgs: [marketId]\r\n * });\r\n * ```\r\n */\r\nexport function useEncryptedTransaction(config: ContractConfig) {\r\n  const { client, isReady } = useFhevmClient();\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [error, setError] = useState<Error | null>(null);\r\n\r\n  const sendEncryptedTransaction = useCallback(\r\n    async (params: EncryptedTransactionParams) => {\r\n      if (!client || !isReady) {\r\n        const error = new Error('FHEVM client not ready');\r\n        setError(error);\r\n        return null;\r\n      }\r\n\r\n      if (!config.signer) {\r\n        const error = new Error('Signer not provided');\r\n        setError(error);\r\n        return null;\r\n      }\r\n\r\n      setIsLoading(true);\r\n      setError(null);\r\n\r\n      try {\r\n        // Get user address\r\n        const userAddress = await (config.signer as Signer).getAddress();\r\n\r\n        // Encrypt inputs\r\n        const encryptionService = new EncryptionService(client);\r\n        const encryptedData = await encryptionService.encryptBatch(\r\n          config.address,\r\n          userAddress,\r\n          params.encryptedInputs\r\n        );\r\n\r\n        // Create contract service\r\n        const contractService = new ContractService(config);\r\n\r\n        // Prepare transaction arguments\r\n        const txArgs = [\r\n          ...encryptedData.handles,\r\n          encryptedData.inputProof,\r\n          ...(params.additionalArgs || []),\r\n        ];\r\n\r\n        // Send transaction\r\n        const tx = await contractService.write(params.method, txArgs, params.overrides);\r\n\r\n        return tx;\r\n      } catch (err) {\r\n        const error = err instanceof Error ? err : new Error('Transaction failed');\r\n        setError(error);\r\n        return null;\r\n      } finally {\r\n        setIsLoading(false);\r\n      }\r\n    },\r\n    [client, isReady, config]\r\n  );\r\n\r\n  return {\r\n    sendEncryptedTransaction,\r\n    isLoading,\r\n    error,\r\n  };\r\n}\r\n"],"names":["initFhevm","createInstance","createContext","useState","useEffect","useContext","useCallback","Contract"],"mappings":"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"}